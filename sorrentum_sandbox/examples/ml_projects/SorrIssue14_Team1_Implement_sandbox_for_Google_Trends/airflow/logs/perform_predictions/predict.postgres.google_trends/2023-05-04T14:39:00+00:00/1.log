[2023-05-04 14:42:36,190] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: perform_predictions.predict.postgres.google_trends scheduled__2023-05-04T14:39:00+00:00 [queued]>
[2023-05-04 14:42:36,199] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: perform_predictions.predict.postgres.google_trends scheduled__2023-05-04T14:39:00+00:00 [queued]>
[2023-05-04 14:42:36,200] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2023-05-04 14:42:36,201] {taskinstance.py:1242} INFO - Starting attempt 1 of 1
[2023-05-04 14:42:36,202] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2023-05-04 14:42:36,211] {taskinstance.py:1262} INFO - Executing <Task(BashOperator): predict.postgres.google_trends> on 2023-05-04 14:39:00+00:00
[2023-05-04 14:42:36,215] {standard_task_runner.py:52} INFO - Started process 537 to run task
[2023-05-04 14:42:36,220] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'perform_predictions', 'predict.postgres.google_trends', 'scheduled__2023-05-04T14:39:00+00:00', '--job-id', '23', '--raw', '--subdir', 'DAGS_FOLDER/***_predictions_scheduler.py', '--cfg-path', '/tmp/tmplyr0pbfe', '--error-file', '/tmp/tmp1kaukdwx']
[2023-05-04 14:42:36,221] {standard_task_runner.py:77} INFO - Job 23: Subtask predict.postgres.google_trends
[2023-05-04 14:42:36,266] {logging_mixin.py:109} INFO - Running <TaskInstance: perform_predictions.predict.postgres.google_trends scheduled__2023-05-04T14:39:00+00:00 [running]> on host c896eb598e2f
[2023-05-04 14:42:36,313] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@example.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=perform_predictions
AIRFLOW_CTX_TASK_ID=predict.postgres.google_trends
AIRFLOW_CTX_EXECUTION_DATE=2023-05-04T14:39:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-05-04T14:39:00+00:00
[2023-05-04 14:42:36,315] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2023-05-04 14:42:36,317] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'sleep 5 && /cmamp/src/load_validate_transform.py --source_table google_trends_data --target_table google_trends_predictions --topic Air_Conditioner']
[2023-05-04 14:42:36,326] {subprocess.py:85} INFO - Output:
[2023-05-04 14:43:47,811] {subprocess.py:89} INFO - Data fetched from 'google_trends_data' table:
[2023-05-04 14:43:47,815] {subprocess.py:89} INFO -                Topic      Time  Frequency
[2023-05-04 14:43:47,816] {subprocess.py:89} INFO - 0    air conditioner  Sep 2010       19.0
[2023-05-04 14:43:47,817] {subprocess.py:89} INFO - 1    air conditioner  Oct 2010       12.0
[2023-05-04 14:43:47,818] {subprocess.py:89} INFO - 2    air conditioner  Nov 2010        9.0
[2023-05-04 14:43:47,819] {subprocess.py:89} INFO - 3    air conditioner  Dec 2010        8.0
[2023-05-04 14:43:47,820] {subprocess.py:89} INFO - 4    air conditioner  Jan 2011       10.0
[2023-05-04 14:43:47,821] {subprocess.py:89} INFO - ..               ...       ...        ...
[2023-05-04 14:43:47,822] {subprocess.py:89} INFO - 227  air conditioner  Dec 2022       18.0
[2023-05-04 14:43:47,823] {subprocess.py:89} INFO - 228  air conditioner  Jan 2023       19.0
[2023-05-04 14:43:47,824] {subprocess.py:89} INFO - 229  air conditioner  Feb 2023       20.0
[2023-05-04 14:43:47,824] {subprocess.py:89} INFO - 230  air conditioner  Mar 2023       21.0
[2023-05-04 14:43:47,825] {subprocess.py:89} INFO - 231  air conditioner  Apr 2023       36.0
[2023-05-04 14:43:47,826] {subprocess.py:89} INFO - 
[2023-05-04 14:43:47,827] {subprocess.py:89} INFO - [232 rows x 3 columns]
[2023-05-04 14:43:47,828] {subprocess.py:89} INFO - 
[2023-05-04 14:43:47,829] {subprocess.py:89} INFO - Running all QA checks:
[2023-05-04 14:43:47,830] {subprocess.py:89} INFO - DenormalizedDatasetCheck: PASSED
[2023-05-04 14:43:47,831] {subprocess.py:89} INFO - 
[2023-05-04 14:43:47,832] {subprocess.py:89} INFO - Step 1: Converting to Dask Dataframe, Done
[2023-05-04 14:43:47,833] {subprocess.py:89} INFO - Step 2: Preprocessing before prediction, Done
[2023-05-04 14:43:47,834] {subprocess.py:89} INFO - Performing stepwise search to minimize aic
[2023-05-04 14:43:47,835] {subprocess.py:89} INFO -  ARIMA(0,1,0)(0,1,0)[12]             : AIC=1603.258, Time=0.03 sec
[2023-05-04 14:43:47,836] {subprocess.py:89} INFO -  ARIMA(1,1,0)(1,1,0)[12]             : AIC=1481.210, Time=0.11 sec
[2023-05-04 14:43:47,837] {subprocess.py:89} INFO -  ARIMA(0,1,1)(0,1,1)[12]             : AIC=1412.251, Time=0.19 sec
[2023-05-04 14:43:47,838] {subprocess.py:89} INFO -  ARIMA(0,1,1)(0,1,0)[12]             : AIC=1475.812, Time=0.05 sec
[2023-05-04 14:43:47,839] {subprocess.py:89} INFO -  ARIMA(0,1,1)(1,1,1)[12]             : AIC=1414.168, Time=0.23 sec
[2023-05-04 14:43:47,840] {subprocess.py:89} INFO -  ARIMA(0,1,1)(0,1,2)[12]             : AIC=1414.173, Time=0.44 sec
[2023-05-04 14:43:47,841] {subprocess.py:89} INFO -  ARIMA(0,1,1)(1,1,0)[12]             : AIC=1434.415, Time=0.11 sec
[2023-05-04 14:43:47,842] {subprocess.py:89} INFO -  ARIMA(0,1,1)(1,1,2)[12]             : AIC=1416.251, Time=0.67 sec
[2023-05-04 14:43:47,843] {subprocess.py:89} INFO -  ARIMA(0,1,0)(0,1,1)[12]             : AIC=1483.548, Time=0.12 sec
[2023-05-04 14:43:47,844] {subprocess.py:89} INFO -  ARIMA(1,1,1)(0,1,1)[12]             : AIC=1407.465, Time=0.32 sec
[2023-05-04 14:43:47,845] {subprocess.py:89} INFO -  ARIMA(1,1,1)(0,1,0)[12]             : AIC=1477.432, Time=0.10 sec
[2023-05-04 14:43:47,846] {subprocess.py:89} INFO -  ARIMA(1,1,1)(1,1,1)[12]             : AIC=1409.465, Time=0.48 sec
[2023-05-04 14:43:47,847] {subprocess.py:89} INFO -  ARIMA(1,1,1)(0,1,2)[12]             : AIC=1409.465, Time=0.69 sec
[2023-05-04 14:43:47,848] {subprocess.py:89} INFO -  ARIMA(1,1,1)(1,1,0)[12]             : AIC=1433.756, Time=0.16 sec
[2023-05-04 14:43:47,849] {subprocess.py:89} INFO -  ARIMA(1,1,1)(1,1,2)[12]             : AIC=inf, Time=2.61 sec
[2023-05-04 14:43:47,850] {subprocess.py:89} INFO -  ARIMA(1,1,0)(0,1,1)[12]             : AIC=1443.399, Time=0.15 sec
[2023-05-04 14:43:47,851] {subprocess.py:89} INFO -  ARIMA(2,1,1)(0,1,1)[12]             : AIC=1407.200, Time=0.40 sec
[2023-05-04 14:43:47,852] {subprocess.py:89} INFO -  ARIMA(2,1,1)(0,1,0)[12]             : AIC=1477.601, Time=0.14 sec
[2023-05-04 14:43:47,853] {subprocess.py:89} INFO -  ARIMA(2,1,1)(1,1,1)[12]             : AIC=1409.200, Time=0.49 sec
[2023-05-04 14:43:47,854] {subprocess.py:89} INFO -  ARIMA(2,1,1)(0,1,2)[12]             : AIC=1409.200, Time=0.83 sec
[2023-05-04 14:43:47,855] {subprocess.py:89} INFO -  ARIMA(2,1,1)(1,1,0)[12]             : AIC=1434.219, Time=0.32 sec
[2023-05-04 14:43:47,856] {subprocess.py:89} INFO -  ARIMA(2,1,1)(1,1,2)[12]             : AIC=inf, Time=2.85 sec
[2023-05-04 14:43:47,857] {subprocess.py:89} INFO -  ARIMA(2,1,0)(0,1,1)[12]             : AIC=1440.848, Time=0.27 sec
[2023-05-04 14:43:47,858] {subprocess.py:89} INFO -  ARIMA(3,1,1)(0,1,1)[12]             : AIC=1406.760, Time=0.65 sec
[2023-05-04 14:43:47,858] {subprocess.py:89} INFO -  ARIMA(3,1,1)(0,1,0)[12]             : AIC=1479.601, Time=0.17 sec
[2023-05-04 14:43:47,859] {subprocess.py:89} INFO -  ARIMA(3,1,1)(1,1,1)[12]             : AIC=1408.701, Time=0.66 sec
[2023-05-04 14:43:47,860] {subprocess.py:89} INFO -  ARIMA(3,1,1)(0,1,2)[12]             : AIC=1408.701, Time=1.51 sec
[2023-05-04 14:43:47,861] {subprocess.py:89} INFO -  ARIMA(3,1,1)(1,1,0)[12]             : AIC=1434.982, Time=0.40 sec
[2023-05-04 14:43:47,862] {subprocess.py:89} INFO -  ARIMA(3,1,1)(1,1,2)[12]             : AIC=inf, Time=3.67 sec
[2023-05-04 14:43:47,863] {subprocess.py:89} INFO -  ARIMA(3,1,0)(0,1,1)[12]             : AIC=1438.316, Time=0.35 sec
[2023-05-04 14:43:47,864] {subprocess.py:89} INFO -  ARIMA(4,1,1)(0,1,1)[12]             : AIC=1405.642, Time=0.57 sec
[2023-05-04 14:43:47,865] {subprocess.py:89} INFO -  ARIMA(4,1,1)(0,1,0)[12]             : AIC=1479.393, Time=0.22 sec
[2023-05-04 14:43:47,866] {subprocess.py:89} INFO -  ARIMA(4,1,1)(1,1,1)[12]             : AIC=1407.637, Time=0.95 sec
[2023-05-04 14:43:47,868] {subprocess.py:89} INFO -  ARIMA(4,1,1)(0,1,2)[12]             : AIC=1407.637, Time=1.75 sec
[2023-05-04 14:43:47,868] {subprocess.py:89} INFO -  ARIMA(4,1,1)(1,1,0)[12]             : AIC=1435.829, Time=0.48 sec
[2023-05-04 14:43:47,869] {subprocess.py:89} INFO -  ARIMA(4,1,1)(1,1,2)[12]             : AIC=inf, Time=3.97 sec
[2023-05-04 14:43:47,870] {subprocess.py:89} INFO -  ARIMA(4,1,0)(0,1,1)[12]             : AIC=1432.273, Time=0.37 sec
[2023-05-04 14:43:47,872] {subprocess.py:89} INFO -  ARIMA(5,1,1)(0,1,1)[12]             : AIC=1406.552, Time=0.82 sec
[2023-05-04 14:43:47,873] {subprocess.py:89} INFO -  ARIMA(4,1,2)(0,1,1)[12]             : AIC=1398.185, Time=1.50 sec
[2023-05-04 14:43:47,873] {subprocess.py:89} INFO -  ARIMA(4,1,2)(0,1,0)[12]             : AIC=inf, Time=0.62 sec
[2023-05-04 14:43:47,874] {subprocess.py:89} INFO -  ARIMA(4,1,2)(1,1,1)[12]             : AIC=1399.495, Time=2.42 sec
[2023-05-04 14:43:47,875] {subprocess.py:89} INFO -  ARIMA(4,1,2)(0,1,2)[12]             : AIC=1399.488, Time=4.67 sec
[2023-05-04 14:43:47,876] {subprocess.py:89} INFO -  ARIMA(4,1,2)(1,1,0)[12]             : AIC=1438.862, Time=0.78 sec
[2023-05-04 14:43:47,877] {subprocess.py:89} INFO -  ARIMA(4,1,2)(1,1,2)[12]             : AIC=inf, Time=5.06 sec
[2023-05-04 14:43:47,878] {subprocess.py:89} INFO -  ARIMA(3,1,2)(0,1,1)[12]             : AIC=1397.001, Time=1.31 sec
[2023-05-04 14:43:47,879] {subprocess.py:89} INFO -  ARIMA(3,1,2)(0,1,0)[12]             : AIC=inf, Time=0.59 sec
[2023-05-04 14:43:47,880] {subprocess.py:89} INFO -  ARIMA(3,1,2)(1,1,1)[12]             : AIC=1398.158, Time=1.76 sec
[2023-05-04 14:43:47,881] {subprocess.py:89} INFO -  ARIMA(3,1,2)(0,1,2)[12]             : AIC=1398.146, Time=2.82 sec
[2023-05-04 14:43:47,882] {subprocess.py:89} INFO -  ARIMA(3,1,2)(1,1,0)[12]             : AIC=1433.977, Time=1.19 sec
[2023-05-04 14:43:47,883] {subprocess.py:89} INFO -  ARIMA(3,1,2)(1,1,2)[12]             : AIC=1400.020, Time=4.37 sec
[2023-05-04 14:43:47,884] {subprocess.py:89} INFO -  ARIMA(2,1,2)(0,1,1)[12]             : AIC=1408.392, Time=0.72 sec
[2023-05-04 14:43:47,885] {subprocess.py:89} INFO -  ARIMA(3,1,3)(0,1,1)[12]             : AIC=1407.252, Time=2.22 sec
[2023-05-04 14:43:47,886] {subprocess.py:89} INFO -  ARIMA(2,1,3)(0,1,1)[12]             : AIC=1407.424, Time=1.10 sec
[2023-05-04 14:43:47,886] {subprocess.py:89} INFO -  ARIMA(4,1,3)(0,1,1)[12]             : AIC=1400.372, Time=2.34 sec
[2023-05-04 14:43:47,887] {subprocess.py:89} INFO -  ARIMA(3,1,2)(0,1,1)[12] intercept   : AIC=1410.754, Time=2.03 sec
[2023-05-04 14:43:47,888] {subprocess.py:89} INFO - 
[2023-05-04 14:43:47,889] {subprocess.py:89} INFO - Best model:  ARIMA(3,1,2)(0,1,1)[12]
[2023-05-04 14:43:47,890] {subprocess.py:89} INFO - Total fit time: 63.862 seconds
[2023-05-04 14:43:47,891] {subprocess.py:89} INFO - Step 4: Predicting best fit using AIRMA models, Done
[2023-05-04 14:43:47,892] {subprocess.py:89} INFO - Step 5: Reformatting predictions according to DB requirements, Done
[2023-05-04 14:43:47,893] {subprocess.py:89} INFO - Step 6: Reformatting historical data according to DB requirements, Done
[2023-05-04 14:43:47,894] {subprocess.py:89} INFO - Step 7: Concatinating historical data with predictions, Done
[2023-05-04 14:43:47,895] {subprocess.py:89} INFO - Step 8: converting frequencies to 'int', Done
[2023-05-04 14:43:48,055] {subprocess.py:93} INFO - Command exited with return code 0
[2023-05-04 14:43:48,079] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=perform_predictions, task_id=predict.postgres.google_trends, execution_date=20230504T143900, start_date=20230504T144236, end_date=20230504T144348
[2023-05-04 14:43:48,102] {local_task_job.py:154} INFO - Task exited with return code 0
[2023-05-04 14:43:48,126] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
