[2023-05-04 17:54:48,623] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: perform_predictions.predict.postgres.google_trends scheduled__2023-05-04T17:51:00+00:00 [queued]>
[2023-05-04 17:54:48,633] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: perform_predictions.predict.postgres.google_trends scheduled__2023-05-04T17:51:00+00:00 [queued]>
[2023-05-04 17:54:48,634] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2023-05-04 17:54:48,635] {taskinstance.py:1242} INFO - Starting attempt 1 of 1
[2023-05-04 17:54:48,635] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2023-05-04 17:54:48,644] {taskinstance.py:1262} INFO - Executing <Task(BashOperator): predict.postgres.google_trends> on 2023-05-04 17:51:00+00:00
[2023-05-04 17:54:48,648] {standard_task_runner.py:52} INFO - Started process 740 to run task
[2023-05-04 17:54:48,651] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'perform_predictions', 'predict.postgres.google_trends', 'scheduled__2023-05-04T17:51:00+00:00', '--job-id', '25', '--raw', '--subdir', 'DAGS_FOLDER/***_predictions_scheduler.py', '--cfg-path', '/tmp/tmpisk5ps9u', '--error-file', '/tmp/tmpc761v3xg']
[2023-05-04 17:54:48,653] {standard_task_runner.py:77} INFO - Job 25: Subtask predict.postgres.google_trends
[2023-05-04 17:54:48,694] {logging_mixin.py:109} INFO - Running <TaskInstance: perform_predictions.predict.postgres.google_trends scheduled__2023-05-04T17:51:00+00:00 [running]> on host c896eb598e2f
[2023-05-04 17:54:48,740] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@example.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=perform_predictions
AIRFLOW_CTX_TASK_ID=predict.postgres.google_trends
AIRFLOW_CTX_EXECUTION_DATE=2023-05-04T17:51:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-05-04T17:51:00+00:00
[2023-05-04 17:54:48,742] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2023-05-04 17:54:48,743] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'sleep 5 && /cmamp/src/load_validate_transform.py --source_table google_trends_data --target_table google_trends_predictions --topic Desktop']
[2023-05-04 17:54:48,752] {subprocess.py:85} INFO - Output:
[2023-05-04 17:55:01,260] {subprocess.py:89} INFO - Data fetched from 'google_trends_data' table:
[2023-05-04 17:55:01,262] {subprocess.py:89} INFO -        Topic      Time  Frequency
[2023-05-04 17:55:01,265] {subprocess.py:89} INFO - 0    desktop  Jan 2004      100.0
[2023-05-04 17:55:01,267] {subprocess.py:89} INFO - 1    desktop  Feb 2004       95.0
[2023-05-04 17:55:01,269] {subprocess.py:89} INFO - 2    desktop  Mar 2004       90.0
[2023-05-04 17:55:01,269] {subprocess.py:89} INFO - 3    desktop  Apr 2004       81.0
[2023-05-04 17:55:01,270] {subprocess.py:89} INFO - 4    desktop  May 2004       81.0
[2023-05-04 17:55:01,272] {subprocess.py:89} INFO - ..       ...       ...        ...
[2023-05-04 17:55:01,273] {subprocess.py:89} INFO - 227  desktop  Dec 2022       25.0
[2023-05-04 17:55:01,274] {subprocess.py:89} INFO - 228  desktop  Jan 2023       26.0
[2023-05-04 17:55:01,274] {subprocess.py:89} INFO - 229  desktop  Feb 2023       27.0
[2023-05-04 17:55:01,275] {subprocess.py:89} INFO - 230  desktop  Mar 2023       27.0
[2023-05-04 17:55:01,276] {subprocess.py:89} INFO - 231  desktop  Apr 2023       24.0
[2023-05-04 17:55:01,277] {subprocess.py:89} INFO - 
[2023-05-04 17:55:01,277] {subprocess.py:89} INFO - [232 rows x 3 columns]
[2023-05-04 17:55:01,278] {subprocess.py:89} INFO - 
[2023-05-04 17:55:01,279] {subprocess.py:89} INFO - Running all QA checks:
[2023-05-04 17:55:01,280] {subprocess.py:89} INFO - DenormalizedDatasetCheck: PASSED
[2023-05-04 17:55:01,281] {subprocess.py:89} INFO - 
[2023-05-04 17:55:01,282] {subprocess.py:89} INFO - Step 1: Converting to Dask Dataframe, Done
[2023-05-04 17:55:01,283] {subprocess.py:89} INFO - Step 2: Preprocessing before prediction, Done
[2023-05-04 17:55:01,284] {subprocess.py:89} INFO - Performing stepwise search to minimize aic
[2023-05-04 17:55:01,285] {subprocess.py:89} INFO -  ARIMA(0,1,0)(0,1,0)[12]             : AIC=1070.613, Time=0.03 sec
[2023-05-04 17:55:01,286] {subprocess.py:89} INFO -  ARIMA(1,1,0)(1,1,0)[12]             : AIC=1018.919, Time=0.09 sec
[2023-05-04 17:55:01,287] {subprocess.py:89} INFO -  ARIMA(0,1,1)(0,1,1)[12]             : AIC=983.713, Time=0.21 sec
[2023-05-04 17:55:01,288] {subprocess.py:89} INFO -  ARIMA(0,1,1)(0,1,0)[12]             : AIC=1057.143, Time=0.04 sec
[2023-05-04 17:55:01,288] {subprocess.py:89} INFO -  ARIMA(0,1,1)(1,1,1)[12]             : AIC=985.689, Time=0.22 sec
[2023-05-04 17:55:01,289] {subprocess.py:89} INFO -  ARIMA(0,1,1)(0,1,2)[12]             : AIC=985.683, Time=0.38 sec
[2023-05-04 17:55:01,290] {subprocess.py:89} INFO -  ARIMA(0,1,1)(1,1,0)[12]             : AIC=1015.698, Time=0.08 sec
[2023-05-04 17:55:01,291] {subprocess.py:89} INFO -  ARIMA(0,1,1)(1,1,2)[12]             : AIC=inf, Time=2.90 sec
[2023-05-04 17:55:01,292] {subprocess.py:89} INFO -  ARIMA(0,1,0)(0,1,1)[12]             : AIC=990.471, Time=0.10 sec
[2023-05-04 17:55:01,293] {subprocess.py:89} INFO -  ARIMA(1,1,1)(0,1,1)[12]             : AIC=983.979, Time=0.45 sec
[2023-05-04 17:55:01,294] {subprocess.py:89} INFO -  ARIMA(0,1,2)(0,1,1)[12]             : AIC=985.477, Time=0.22 sec
[2023-05-04 17:55:01,294] {subprocess.py:89} INFO -  ARIMA(1,1,0)(0,1,1)[12]             : AIC=984.732, Time=0.13 sec
[2023-05-04 17:55:01,295] {subprocess.py:89} INFO -  ARIMA(1,1,2)(0,1,1)[12]             : AIC=987.391, Time=0.25 sec
[2023-05-04 17:55:01,296] {subprocess.py:89} INFO -  ARIMA(0,1,1)(0,1,1)[12] intercept   : AIC=983.956, Time=0.26 sec
[2023-05-04 17:55:01,297] {subprocess.py:89} INFO - 
[2023-05-04 17:55:01,298] {subprocess.py:89} INFO - Best model:  ARIMA(0,1,1)(0,1,1)[12]
[2023-05-04 17:55:01,299] {subprocess.py:89} INFO - Total fit time: 5.357 seconds
[2023-05-04 17:55:01,300] {subprocess.py:89} INFO - Step 4: Predicting best fit using AIRMA models, Done
[2023-05-04 17:55:01,301] {subprocess.py:89} INFO - Step 5: Reformatting predictions according to DB requirements, Done
[2023-05-04 17:55:01,301] {subprocess.py:89} INFO - Step 6: Reformatting historical data according to DB requirements, Done
[2023-05-04 17:55:01,302] {subprocess.py:89} INFO - Step 7: Concatinating historical data with predictions, Done
[2023-05-04 17:55:01,303] {subprocess.py:89} INFO - Step 8: converting frequencies to 'int', Done
[2023-05-04 17:55:01,482] {subprocess.py:93} INFO - Command exited with return code 0
[2023-05-04 17:55:01,508] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=perform_predictions, task_id=predict.postgres.google_trends, execution_date=20230504T175100, start_date=20230504T175448, end_date=20230504T175501
[2023-05-04 17:55:01,557] {local_task_job.py:154} INFO - Task exited with return code 0
[2023-05-04 17:55:01,586] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
